@import helper._
@import modules.utility.twirl.CustomHelpers._
@import modules.movie.{CreateMovieForm}
@import modules.util.{Country, Language}
@import modules.director.{Director}
@import modules.actor.{Actor}
@import modules.genre.{Genre}
@(
    movieForm: Form[CreateMovieForm],
    directors: Seq[Director],
    actors: Seq[Actor],
    genres: Seq[Genre],
    id: Option[Long] = None
)(implicit request: MessagesRequestHeader, flash: Flash)

@main(id.map(_ => "Update movie").getOrElse("Create movie")) {
    @form(
        id.map(idVal => modules.movie.routes.MovieController.update(idVal)).getOrElse(modules.movie.routes.MovieController.saveNewMovie()),
        'class -> s"ui form ${if(movieForm.hasErrors) "error" else ""}"
    ) {
        @inputText(
            movieForm("title"),
            '_label -> "Title"
        )
        @inputText(
            movieForm("description"),
            '_label -> "Description"
        )
        @inputText(
            movieForm("releaseDate"), 'type -> "date",
            '_label -> "Release date"
        )
        @select(
            movieForm("country"),
            Country.values.map(countryVal => (countryVal.dbName, countryVal.countryName)).toSeq,
            '_label -> "Country"
        )
        @select(
            movieForm("language"),
            Language.values.map(languageVal => (languageVal.dbName, languageVal.actualName)).toSeq,
            '_label -> "Language"
        )

        @select(
            movieForm("director"),
            directors.map(director => (director.id.toString, director.firstName + director.lastName)).toSeq,
            '_label -> "Directors",
            'multiple -> true
        )

        @select(
            movieForm("actor"),
            actors.map(actor => (actor.id.toString, actor.firstName + actor.lastName)).toSeq,
            '_label -> "Actors",
            'multiple -> true
        )

        @select(
            movieForm("genre"),
            genres.map(genre => (genre.id.toString, genre.title.toLowerCase.capitalize)).toSeq,
            '_label -> "Genres",
            'multiple -> true
        )

        @if(id != None) {
            <button id="edit-submit" class="ui primary button" type="submit">Update Movie</button>
        } else {
            <button id="create-submit" class="ui primary button" type="submit">Add Movie</button>
        }
        <a class="ui button" href="@modules.movie.routes.MovieController.list()">Cancel</a>
    }
}